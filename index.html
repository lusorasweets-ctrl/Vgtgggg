<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚õèÔ∏è Mining Game Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        .header {
            text-align: center;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .daily-bonus {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .daily-bonus:hover {
            transform: scale(1.05);
        }

        .balance-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 10px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .mining-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .mining-button {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            margin: 15px 0;
            transition: transform 0.3s;
        }

        .mining-button:hover {
            transform: scale(1.05);
        }

        .mining-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .progress-bar {
            background: rgba(0,0,0,0.3);
            height: 10px;
            border-radius: 5px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #00f2fe 0%, #4facfe 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s;
        }

        .nav-tabs {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.9);
            padding: 10px;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .nav-tabs div {
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 10px;
            transition: background 0.3s;
            font-size: 12px;
        }

        .nav-tabs div:hover {
            background: rgba(255,255,255,0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .box-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .box-item {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            border: 2px solid;
            transition: transform 0.3s;
        }

        .box-item:hover {
            transform: scale(1.05);
        }

        .box-item.rare { border-color: #4facfe; }
        .box-item.epic { border-color: #f093fb; }
        .box-item.legend { border-color: #ffd700; }

        .box-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .hammer-list {
            display: grid;
            gap: 10px;
        }

        .hammer-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: none;
            font-size: 16px;
        }

        .button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.3s;
        }

        .button:hover {
            transform: scale(1.05);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 20px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            max-height: 80vh;
            overflow-y: auto;
        }

        .admin-panel {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
        }

        .user-list, .payment-list {
            display: grid;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item, .payment-item {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
        }

        .payment-item {
            border-left: 4px solid #4facfe;
        }

        .payment-item.pending {
            border-left-color: #ffd700;
        }

        .payment-item.verified {
            border-left-color: #4caf50;
        }

        .payment-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .payment-actions button {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .approve-btn {
            background: #4caf50;
            color: white;
        }

        .reject-btn {
            background: #f44336;
            color: white;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 2000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚õèÔ∏è Mining Game </h1>
            <p>Xo≈ü g…ôldiniz!</p>
        </div>

        <div class="daily-bonus" onclick="claimDailyBonus()">
            <h3>üéÅ G√ºnd…ôlik Bonus</h3>
            <p>H…ôr g√ºn daxil ol v…ô bonus qazan!</p>
            <p style="font-size: 24px; font-weight: bold;">0.0000011 üí∞</p>
        </div>

        <div class="balance-card">
            <div class="balance-label">üí∞ Balans</div>
            <div id="goldBalance" class="balance-amount">0.00000</div>
            <div class="balance-label" style="margin-top: 15px;">üíµ AZN</div>
            <div id="aznBalance" class="balance-amount" style="font-size: 24px;">0.00</div>
            
            <div class="stats-row">
                <div class="stat-item">
                    <div id="totalEarned" class="stat-value">0.000</div>
                    <div class="stat-label">√úmumi Qazanc</div>
                </div>
                <div class="stat-item">
                    <div id="hammerCount" class="stat-value">0</div>
                    <div class="stat-label">√á…ôkicl…ôrim</div>
                </div>
                <div class="stat-item">
                    <div id="dailyHammerEarning" class="stat-value">0.00000</div>
                    <div class="stat-label">G√ºnl√ºk √á…ôkic</div>
                </div>
            </div>
        </div>

        <div class="mining-section">
            <div class="mining-rate">‚ö° S√ºr…ôt: <span id="miningRate">0.00010</span>/ay</div>
            <button id="miningButton" class="mining-button" onclick="toggleMining()">Mining Ba≈üla</button>
            <div id="miningTimer" class="timer"></div>
            <div class="progress-bar">
                <div id="miningProgress" class="progress-fill"></div>
            </div>
        </div>

        <div id="boxesTab" class="tab-content active">
            <div class="box-grid">
                <div class="box-item rare" onclick="showBoxPayment('rare', 0.015)">
                    <div class="box-icon">üì¶</div>
                    <div class="box-name">Rare Qutu</div>
                    <div class="box-bonus">√á…ôkicl…ôr: 0.00001-0.00004/g√ºn</div>
                    <div class="box-cost">üíé 0.015 TON</div>
                </div>
                <div class="box-item epic" onclick="showBoxPayment('epic', 0.1)">
                    <div class="box-icon">üéÅ</div>
                    <div class="box-name">Epic Qutu</div>
                    <div class="box-bonus">√á…ôkicl…ôr: 0.00006-0.00009/g√ºn</div>
                    <div class="box-cost">üíé 0.1 TON</div>
                </div>
                <div class="box-item legend" onclick="showBoxPayment('legend', 0.5)">
                    <div class="box-icon">üíé</div>
                    <div class="box-name">Legend Qutu</div>
                    <div class="box-bonus">√á…ôkicl…ôr: 0.0001-0.0005/g√ºn</div>
                    <div class="box-cost">üíé 0.5 TON</div>
                </div>
                <div class="box-item" style="border-color: #00ffff;" onclick="showBoxPayment('mystery', 0.05, true)">
                    <div class="box-icon">üé∞</div>
                    <div class="box-name">Mystery Qutu</div>
                    <div class="box-bonus">√á…ôkic: 0.000005/g√ºn</div>
                    <div class="box-cost">üí∞ 0.05 Qƒ±zƒ±l</div>
                </div>
            </div>
        </div>

        <div id="hammersTab" class="tab-content">
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
                <h3>üí∞ G√ºnl√ºk Qazanc</h3>
                <p style="font-size: 24px; font-weight: bold;"><span id="totalDailyRate">0.00000</span> qƒ±zƒ±l/g√ºn</p>
                <button class="button" onclick="collectDailyHammers()" style="margin-top: 15px;">üî® G√ºnd…ôlik Topla≈üdƒ±r</button>
            </div>
            <div id="hammerList" class="hammer-list"></div>
        </div>

        <div id="withdrawTab" class="tab-content">
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                <h3 style="margin-bottom: 20px;">üè¶ Pul √áƒ±xarƒ±≈üƒ±</h3>
                <p>Minimum: 3 AZN</p>
                <div class="input-group">
                    <label>M…ôbl…ôƒü (AZN)</label>
                    <input type="number" id="withdrawAmount" min="3" placeholder="M…ôbl…ôƒü daxil edin">
                </div>
                <div class="input-group">
                    <label>Bank Kartƒ± (16 r…ôq…ôm)</label>
                    <input type="text" id="bankCard" maxlength="16" placeholder="1234567890123456">
                </div>
                <button class="button" onclick="requestWithdraw()">√áƒ±xarƒ±≈ü Et</button>
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                    <h4>Son √áƒ±xarƒ±≈ülar</h4>
                    <div id="withdrawHistory"></div>
                </div>
            </div>
        </div>

        <div id="leaderboardTab" class="tab-content">
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                <h3 style="margin-bottom: 20px; text-align: center;">üèÜ Liderlik L√∂vh…ôsi</h3>
                <div id="leaderboardList"></div>
            </div>
        </div>

        <div id="adminTab" class="tab-content">
            <div class="admin-panel">
                <div style="text-align: center; margin-bottom: 20px;">
                    <h2>‚öôÔ∏è Admin Panel</h2>
                </div>
                
                <div style="background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%); padding: 15px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
                    <h3>ü§ñ Avtomatik Sistem</h3>
                    <div style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 10px; margin: 15px 0;">
                        <p>‚úÖ TON √∂d…ôni≈ül…ôri avtomatik yoxlanƒ±lƒ±r</p>
                        <p>üîÑ H…ôr 20 saniy…ôd…ô blockchain scan olunur</p>
                        <p id="lastCheckTime" style="opacity: 0.8; font-size: 12px; margin-top: 5px;">Son yoxlama: -</p>
                    </div>
                    <button class="button" onclick="openTonScan()">üåê TONScan-d…ô Wallet-i A√ß</button>
                </div>

                <h4 style="margin-bottom: 15px;">üí∞ G√∂zl…ôy…ôn √ñd…ôni≈ül…ôr</h4>
                <div id="pendingPayments" class="payment-list" style="margin-bottom: 30px;"></div>
                
                <h4 style="margin-bottom: 15px;">‚úÖ T…ôsdiql…ônmi≈ü √ñd…ôni≈ül…ôr</h4>
                <div id="verifiedPayments" class="payment-list" style="margin-bottom: 30px;"></div>
            </div>
        </div>
    </div>

    <div class="nav-tabs">
        <div onclick="switchTab('boxesTab')">üì¶ Qutular</div>
        <div onclick="switchTab('hammersTab')">üî® √á…ôkicl…ôrim</div>
        <div onclick="switchTab('withdrawTab')">üè¶ √áƒ±xarƒ±≈ü</div>
        <div onclick="switchTab('leaderboardTab')">üèÜ Liderlik</div>
        <div onclick="switchTab('adminTab')" id="adminTabBtn" style="display: none;">‚öôÔ∏è Admin</div>
    </div>

    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <div id="rewardIcon" style="font-size: 64px; margin-bottom: 20px;">üéâ</div>
            <h2 id="rewardTitle">T…ôbrikl…ôr!</h2>
            <p id="rewardMessage" style="margin: 20px 0;"></p>
            <button class="button" onclick="closeModal('rewardModal')">Baƒüla</button>
        </div>
    </div>

    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 20px;">üíé TON √ñd…ôni≈üi</h2>
            <div id="paymentModalContent"></div>
        </div>
    </div>

    <script>
        const ADMIN_ID = 8197921729;
        const TON_WALLET = 'UQAs3cgBB9_Dl8KLaAqC4cuJ_K6x0TluPTgH9CqzdlzJNhxF';
        const TONCENTER_API_KEY = '7831704eaa33471e13a934cd52e7b2d2bb104ad6b376d947b4a6a6317de1be21';
        const MIN_WITHDRAW = 3;
        const MINING_DURATION = 30 * 24 * 60 * 60 * 1000;
        const GOLD_TO_AZN_RATE = 10000;
        const CHECK_INTERVAL = 20000;

        let gameState = {
            userId: Date.now(),
            goldBalance: 0,
            totalEarned: 0,
            hammers: [],
            miningActive: false,
            miningStartTime: null,
            lastDailyBonus: null,
            withdrawHistory: [],
            pendingPayments: [],
            verifiedPayments: [],
            isAdmin: false
        };

        let paymentCheckInterval = null;

        function init() {
            loadGameState();
            updateUI();
            setInterval(updateMining, 1000);
            checkAdmin();
            
            if (gameState.isAdmin) {
                startPaymentChecker();
            }
        }

        function loadGameState() {
            const saved = localStorage.getItem('miningGameState');
            if (saved) {
                gameState = {...gameState, ...JSON.parse(saved)};
            }
        }

        function saveGameState() {
            localStorage.setItem('miningGameState', JSON.stringify(gameState));
        }

        function updateUI() {
            document.getElementById('goldBalance').textContent = gameState.goldBalance.toFixed(5);
            document.getElementById('aznBalance').textContent = (gameState.goldBalance * GOLD_TO_AZN_RATE).toFixed(2);
            document.getElementById('totalEarned').textContent = gameState.totalEarned.toFixed(3);
            document.getElementById('hammerCount').textContent = gameState.hammers.length;
            
            const dailyRate = gameState.hammers.reduce((sum, h) => sum + h.rate, 0);
            document.getElementById('dailyHammerEarning').textContent = dailyRate.toFixed(5);
            document.getElementById('totalDailyRate').textContent = dailyRate.toFixed(5);
            
            updateHammerList();
            updateWithdrawHistory();
            
            if (gameState.isAdmin) {
                updateAdminPanel();
            }
        }

        function claimDailyBonus() {
            const now = Date.now();
            const lastClaim = gameState.lastDailyBonus || 0;
            const dayInMs = 24 * 60 * 60 * 1000;
            
            if (now - lastClaim < dayInMs) {
                const hoursLeft = Math.ceil((dayInMs - (now - lastClaim)) / (60 * 60 * 1000));
                showNotification(`‚ùå N√∂vb…ôti bonus ${hoursLeft} saatdan sonra!`, 'error');
                return;
            }
            
            const bonus = 0.00005;
            gameState.goldBalance += bonus;
            gameState.totalEarned += bonus;
            gameState.lastDailyBonus = now;
            saveGameState();
            updateUI();
            
            showReward('üéÅ', 'G√ºnd…ôlik Bonus!', `+${bonus.toFixed(5)} qƒ±zƒ±l aldƒ±nƒ±z!`);
        }

        function toggleMining() {
            if (gameState.miningActive) {
                gameState.miningActive = false;
                gameState.miningStartTime = null;
                document.getElementById('miningButton').textContent = 'Mining Ba≈üla';
            } else {
                gameState.miningActive = true;
                gameState.miningStartTime = Date.now();
                document.getElementById('miningButton').textContent = 'Mining Dayandƒ±r';
            }
            saveGameState();
        }

        function updateMining() {
            if (!gameState.miningActive || !gameState.miningStartTime) return;
            
            const elapsed = Date.now() - gameState.miningStartTime;
            const progress = Math.min((elapsed / MINING_DURATION) * 100, 100);
            document.getElementById('miningProgress').style.width = progress + '%';
            
            const remaining = Math.max(MINING_DURATION - elapsed, 0);
            const days = Math.floor(remaining / (24 * 60 * 60 * 1000));
            const hours = Math.floor((remaining % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000));
            const mins = Math.floor((remaining % (60 * 60 * 1000)) / (60 * 1000));
            const secs = Math.floor((remaining % (60 * 1000)) / 1000);
            
            document.getElementById('miningTimer').textContent = 
                `${days}g ${hours}s ${mins}d ${secs}s`;
            
            if (remaining === 0) {
                completeMining();
            }
        }

        function completeMining() {
            const reward = 0.00010;
            gameState.goldBalance += reward;
            gameState.totalEarned += reward;
            gameState.miningActive = false;
            gameState.miningStartTime = null;
            document.getElementById('miningButton').textContent = 'Mining Ba≈üla';
            document.getElementById('miningProgress').style.width = '0%';
            saveGameState();
            updateUI();
            showReward('‚õèÔ∏è', 'Mining Tamamlandƒ±!', `+${reward.toFixed(5)} qƒ±zƒ±l qazandƒ±nƒ±z!`);
        }

        function showBoxPayment(type, price, isGold = false) {
            if (isGold) {
                buyBoxWithGold(type, price);
                return;
            }

            const paymentId = `pay_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            
            const content = `
                <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                    <p style="font-size: 18px; margin-bottom: 15px;">üíé ${price} TON √∂d…ôyin</p>
                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <p style="color: #333; font-size: 12px; margin-bottom: 8px; font-weight: bold;">Wallet √únvanƒ±:</p>
                        <p style="color: #000; font-size: 11px; word-break: break-all; font-family: monospace;">${TON_WALLET}</p>
                    </div>
                    <div style="background: rgba(255,193,7,0.3); padding: 12px; border-radius: 10px; margin-bottom: 15px;">
                        <p style="font-size: 11px; margin-bottom: 5px;">‚ö†Ô∏è <strong>√áOX √ñN∆èMLƒ∞:</strong></p>
                        <p style="font-size: 10px;">Transfer comment-in…ô bu kodu …ôlav…ô edin:</p>
                        <p style="color: #ffd700; font-weight: bold; font-size: 14px; margin-top: 8px; font-family: monospace;">${paymentId}</p>
                    </div>
                    <button class="button" onclick="openTelegramWallet('${type}', ${price}, '${paymentId}')" 
                            style="width: 100%; margin-bottom: 10px; background: linear-gradient(135deg, #0088cc 0%, #00a8e8 100%);">
                        üíé Telegram Wallet il…ô √ñd…ô
                    </button>
                    <p style="font-size: 11px; opacity: 0.8; margin-top: 15px;">
                        ‚úÖ √ñd…ôni≈üd…ôn sonra avtomatik yoxlanƒ±lacaq v…ô qutu a√ßƒ±lacaq
                    </p>
                </div>
                <button class="button" onclick="closeModal('paymentModal')">L…ôƒüv Et</button>
            `;
            
            document.getElementById('paymentModalContent').innerHTML = content;
            openModal('paymentModal');
            
            gameState.pendingPayments.push({
                id: paymentId,
                userId: gameState.userId,
                type: type,
                amount: price,
                timestamp: Date.now(),
                status: 'pending'
            });
            saveGameState();
        }

        function openTelegramWallet(type, amount, paymentId) {
            const tonAmount = Math.floor(amount * 1000000000);
            const comment = paymentId;
            const telegramUrl = `https://t.me/wallet?start=transfer-${TON_WALLET}-${tonAmount}-${encodeURIComponent(comment)}`;
            
            showNotification('üíé Telegram Wallet a√ßƒ±lƒ±r...', 'info');
            window.open(telegramUrl, '_blank');
            closeModal('paymentModal');
            
            setTimeout(() => {
                showNotification('üîç √ñd…ôni≈üiniz yoxlanƒ±lƒ±r... L√ºtf…ôn g√∂zl…ôyin.', 'info');
            }, 2000);
        }

        function buyBoxWithGold(type, price) {
            if (gameState.goldBalance < price) {
                showNotification('‚ùå Kifay…ôt q…ôd…ôr qƒ±zƒ±lƒ±nƒ±z yoxdur!', 'error');
                return;
            }
            
            gameState.goldBalance -= price;
            openBox(type);
            saveGameState();
            updateUI();
        }

        function openBox(type) {
            const hammerRanges = {
                rare: { min: 0.00001, max: 0.00004 },
                epic: { min: 0.00006, max: 0.00009 },
                legend: { min: 0.0001, max: 0.0005 },
                mystery: { min: 0.000005, max: 0.000005 }
            };
            
            const range = hammerRanges[type];
            const rate = Math.random() * (range.max - range.min) + range.min;
            
            const hammer = {
                id: Date.now(),
                type: type,
                rate: rate,
                lastCollected: Date.now()
            };
            
            gameState.hammers.push(hammer);
            saveGameState();
            updateUI();
            
            showReward('üî®', `${type.toUpperCase()} √á…ôkic!`, `G√ºnl√ºk: ${rate.toFixed(5)} qƒ±zƒ±l`);
        }

        function updateHammerList() {
            const list = document.getElementById('hammerList');
            if (gameState.hammers.length === 0) {
                list.innerHTML = '<p style="text-align:center; opacity:0.7;">H…ôl…ô √ß…ôkiciniz yoxdur</p>';
                return;
            }
            
            list.innerHTML = gameState.hammers.map(h => `
                <div class="hammer-item">
                    <div>
                        <div>üî® ${h.type.toUpperCase()} √á…ôkic</div>
                        <div style="opacity:0.7;">+${h.rate.toFixed(5)} qƒ±zƒ±l/g√ºn</div>
                    </div>
                    <button class="button" onclick="sellHammer(${h.id})">Sat</button>
                </div>
            `).join('');
        }

        function collectDailyHammers() {
            const now = Date.now();
            const dayInMs = 24 * 60 * 60 * 1000;
            let totalCollected = 0;
            
            gameState.hammers.forEach(hammer => {
                const timeSinceCollect = now - (hammer.lastCollected || 0);
                if (timeSinceCollect >= dayInMs) {
                    totalCollected += hammer.rate;
                    hammer.lastCollected = now;
                }
            });
            
            if (totalCollected > 0) {
                gameState.goldBalance += totalCollected;
                gameState.totalEarned += totalCollected;
                saveGameState();
                updateUI();
                showReward('üí∞', 'Toplanƒ±ldƒ±!', `+${totalCollected.toFixed(5)} qƒ±zƒ±l`);
            } else {
                showNotification('‚ùå H…ôl…ô toplamaq √º√ß√ºn vaxt √ßatmayƒ±b!', 'error');
            }
        }

        function sellHammer(id) {
            const index = gameState.hammers.findIndex(h => h.id === id);
            if (index !== -1) {
                const hammer = gameState.hammers[index];
                const sellPrice = hammer.rate * 10;
                gameState.goldBalance += sellPrice;
                gameState.hammers.splice(index, 1);
                saveGameState();
                updateUI();
                showReward('üíµ', 'Satƒ±ldƒ±!', `+${sellPrice.toFixed(5)} qƒ±zƒ±l`);
            }
        }

        function requestWithdraw() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const card = document.getElementById('bankCard').value;
            
            if (amount < MIN_WITHDRAW) {
                showNotification(`‚ùå Minimum √ßƒ±xarƒ±≈ü m…ôbl…ôƒüi ${MIN_WITHDRAW} AZN!`, 'error');
                return;
            }
            
            const goldNeeded = amount / GOLD_TO_AZN_RATE;
            if (gameState.goldBalance < goldNeeded) {
                showNotification('‚ùå Kifay…ôt q…ôd…ôr balansƒ±nƒ±z yoxdur!', 'error');
                return;
            }
            
            if (card.length !== 16) {
                showNotification('‚ùå Kart n√∂mr…ôsi 16 r…ôq…ôm olmalƒ±dƒ±r!', 'error');
                return;
            }
            
            gameState.goldBalance -= goldNeeded;
            gameState.withdrawHistory.push({
                amount: amount,
                card: card,
                date: new Date().toLocaleDateString(),
                status: 'G√∂zl…ôm…ôd…ô'
            });
            
            saveGameState();
            updateUI();
            showNotification('‚úÖ √áƒ±xarƒ±≈ü sorƒüunuz g√∂nd…ôrildi!', 'success');
        }

        function updateWithdrawHistory() {
            const history = document.getElementById('withdrawHistory');
            if (gameState.withdrawHistory.length === 0) {
                history.innerHTML = '<p style="opacity:0.7;">H…ôl…ô √ßƒ±xarƒ±≈ü yoxdur</p>';
                return;
            }
            
            history.innerHTML = gameState.withdrawHistory.slice(-5).reverse().map(w => `
                <div style="padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px; margin-top: 10px;">
                    <div>${w.amount} AZN - ${w.date}</div>
                    <div style="opacity:0.7;">${w.status}</div>
                </div>
            `).join('');
        }

        async function checkTONPayments() {
            try {
                const response = await fetch(
                    `https://toncenter.com/api/v2/getTransactions?address=${TON_WALLET}&limit=50&archival=true`,
                    {
                        headers: {
                            'X-API-Key': TONCENTER_API_KEY
                        }
                    }
                );
                
                const data = await response.json();
                
                if (data.ok && data.result) {
                    const transactions = data.result;
                    
                    gameState.pendingPayments.forEach(payment => {
                        if (payment.status === 'pending') {
                            const matchingTx = transactions.find(tx => {
                                if (!tx.in_msg || !tx.in_msg.message) return false;
                                
                                const amount = parseInt(tx.in_msg.value) / 1000000000;
                                const comment = tx.in_msg.message || '';
                                
                                return comment.includes(payment.id) && 
                                       Math.abs(amount - payment.amount) < 0.001;
                            });
                            
                            if (matchingTx) {
                                payment.status = 'verified';
                                payment.verifiedAt = Date.now();
                                payment.txHash = matchingTx.transaction_id?.hash || 'unknown';
                                
                                openBox(payment.type);
                                
                                gameState.verifiedPayments.unshift(payment);
                                
                                showNotification(`‚úÖ ${payment.type.toUpperCase()} qutu √∂d…ôni≈üi t…ôsdiql…ôndi!`, 'success');
                                
                                console.log('‚úÖ √ñd…ôni≈ü t…ôsdiql…ôndi:', payment.id);
                            }
                        }
                    });
                    
                    gameState.pendingPayments = gameState.pendingPayments.filter(p => p.status === 'pending');
                    
                    gameState.verifiedPayments = gameState.verifiedPayments.slice(0, 50);
                    
                    saveGameState();
                    updateUI();
                }
                
                if (gameState.isAdmin) {
                    const timeElement = document.getElementById('lastCheckTime');
                    if (timeElement) {
                        const now = new Date();
                        timeElement.textContent = `Son yoxlama: ${now.toLocaleTimeString('az-AZ')}`;
                    }
                }
                
            } catch (error) {
                console.error('TON payment yoxlama x…ôtasƒ±:', error);
            }
        }

        function startPaymentChecker() {
            checkTONPayments();
            
            if (paymentCheckInterval) {
                clearInterval(paymentCheckInterval);
            }
            
            paymentCheckInterval = setInterval(checkTONPayments, CHECK_INTERVAL);
            console.log('ü§ñ Avtomatik √∂d…ôni≈ü yoxlayƒ±cƒ±sƒ± ba≈üladƒ± (h…ôr 20 saniy…ô)');
        }

        function checkAdmin() {
            gameState.isAdmin = gameState.userId === ADMIN_ID;
            const adminBtn = document.getElementById('adminTabBtn');
            if (adminBtn) {
                adminBtn.style.display = gameState.isAdmin ? 'block' : 'none';
            }
        }

        function updateAdminPanel() {
            const pendingList = document.getElementById('pendingPayments');
            if (gameState.pendingPayments.length === 0) {
                pendingList.innerHTML = '<p style="opacity:0.7; text-align:center;">G√∂zl…ôy…ôn √∂d…ôni≈ü yoxdur</p>';
            } else {
                pendingList.innerHTML = gameState.pendingPayments.map(p => {
                    const elapsed = Math.floor((Date.now() - p.timestamp) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    
                    return `
                        <div class="payment-item pending">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div>
                                    <strong>${p.type.toUpperCase()} Qutu</strong>
                                    <div style="font-size: 12px; opacity: 0.8;">${p.amount} TON</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: #ffd700;">‚è≥ G√∂zl…ôyir</div>
                                    <div style="font-size: 11px; opacity: 0.7;">${minutes}d ${seconds}s</div>
                                </div>
                            </div>
                            <div style="background: rgba(0,0,0,0.2); padding: 8px; border-radius: 6px; font-size: 10px; font-family: monospace; word-break: break-all;">
                                ID: ${p.id}
                            </div>
                            <div class="payment-actions">
                                <button class="approve-btn" onclick="manualApprove('${p.id}')">‚úÖ Manual T…ôsdiq</button>
                                <button class="reject-btn" onclick="rejectPayment('${p.id}')">‚ùå L…ôƒüv Et</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            const verifiedList = document.getElementById('verifiedPayments');
            if (gameState.verifiedPayments.length === 0) {
                verifiedList.innerHTML = '<p style="opacity:0.7; text-align:center;">T…ôsdiql…ônmi≈ü √∂d…ôni≈ü yoxdur</p>';
            } else {
                verifiedList.innerHTML = gameState.verifiedPayments.slice(0, 10).map(p => {
                    const date = new Date(p.verifiedAt).toLocaleString('az-AZ');
                    return `
                        <div class="payment-item verified">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>${p.type.toUpperCase()} Qutu</strong>
                                    <div style="font-size: 12px; opacity: 0.8;">${p.amount} TON</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: #4caf50;">‚úÖ T…ôsdiql…ôndi</div>
                                    <div style="font-size: 11px; opacity: 0.7;">${date}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function manualApprove(paymentId) {
            const payment = gameState.pendingPayments.find(p => p.id === paymentId);
            if (payment) {
                payment.status = 'verified';
                payment.verifiedAt = Date.now();
                payment.manualApproval = true;
                
                openBox(payment.type);
                
                gameState.verifiedPayments.unshift(payment);
                gameState.pendingPayments = gameState.pendingPayments.filter(p => p.id !== paymentId);
                
                saveGameState();
                updateUI();
                showNotification('‚úÖ √ñd…ôni≈ü manual t…ôsdiql…ôndi v…ô qutu a√ßƒ±ldƒ±!', 'success');
            }
        }

        function rejectPayment(paymentId) {
            if (confirm('Bu √∂d…ôni≈üi l…ôƒüv etm…ôk ist…ôdiyinizd…ôn …ôminsiniz?')) {
                gameState.pendingPayments = gameState.pendingPayments.filter(p => p.id !== paymentId);
                saveGameState();
                updateUI();
                showNotification('‚ùå √ñd…ôni≈ü l…ôƒüv edildi', 'error');
            }
        }

        function openTonScan() {
            window.open(`https://tonscan.org/address/${TON_WALLET}`, '_blank');
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }

        function showReward(icon, title, message) {
            document.getElementById('rewardIcon').textContent = icon;
            document.getElementById('rewardTitle').textContent = title;
            document.getElementById('rewardMessage').textContent = message;
            openModal('rewardModal');
        }

        function openModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            
            const colors = {
                success: '#4caf50',
                error: '#f44336',
                info: '#2196f3',
                warning: '#ff9800'
            };
            
            notification.style.background = colors[type] || colors.info;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        init();
        
        window.addEventListener('beforeunload', () => {
            if (paymentCheckInterval) {
                clearInterval(paymentCheckInterval);
            }
        });
    </script>
</body>
</html>
